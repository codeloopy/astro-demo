---
import { HOMEPAGE_ARTICLES_LIMIT } from '../constants'

import MainLayout from '../layouts/main.astro';
import SearchForm from '../components/search_form.astro';
import MostRecentArticle from '../components/most_recent_article.astro';
import Article from '../components/article.astro';


import  {getCollection} from 'astro:content';
import type { CollectionEntry } from "astro:content";


const allBlogArticles: CollectionEntry<'blog'>[] = (await getCollection('blog')).sort((a:CollectionEntry<'blog'>, b:CollectionEntry<'blog'>) => {
  return new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime();
});

const mostRecentarticle:CollectionEntry<'blog'> = allBlogArticles[0];
const otherArticles:CollectionEntry<'blog'>[] = allBlogArticles.slice(1);
---

<MainLayout>
	<!-- Top Grid -->
	<div class="grid grid-cols-1 gap-5 lg:grid-cols-2">
		<div>
			<h1 class="text-5xl font-bold mt-4 mb-8 leading-tight xl:text-6xl">Articles, Stories & Tutorials for Tech People</h1>
			<SearchForm />
		</div>
		<!-- Most Recent Article -->
		<MostRecentArticle article={mostRecentarticle} />
	</div>

	<!-- Main Grid -->
	<div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
		{otherArticles.slice(0, HOMEPAGE_ARTICLES_LIMIT).map(article => {
			return <Article article={article} />;
		})}
	</div>
</MainLayout>
